name: Publish to npm feed
on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Version to publish'
        required: true

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
    # Checks-out the repository under $GITHUB_WORKSPACE, so your job can access it
    - uses: actions/checkout@v2
    - name: yarn install
      run: yarn
    - name: configure git
      run: |
        git config --global user.email github@ci.io
        git config --global user.name 'Github CI'
    - name: setup version
      run: |
        sed -i 's/"version": ".*"/"version": "${{ github.event.inputs.version }}"/' package.json
    - name: cat
      run: cat package.json
    - name: build
      run: yarn build-dist